============================= test session starts ==============================
platform darwin -- Python 3.13.1, pytest-9.0.2, pluggy-1.6.0 -- /Library/Frameworks/Python.framework/Versions/3.13/bin/python3
cachedir: .pytest_cache
Fugue tests will be initialized with options:
rootdir: /Users/tikhon.vodyanov/Ensemble-weights
configfile: pyproject.toml
plugins: anyio-4.12.1, fugue-0.9.4
collecting ... collected 227 items

test.py::TestKNNFinder::test_exact_match_with_ground_truth[100-1] PASSED [  0%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[100-10] PASSED [  0%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[100-50] PASSED [  1%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[100-100] PASSED [  1%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[100-500] PASSED [  2%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[1000-1] PASSED [  2%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[1000-10] PASSED [  3%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[1000-50] PASSED [  3%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[1000-100] PASSED [  3%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[1000-500] PASSED [  4%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[10000-1] PASSED [  4%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[10000-10] PASSED [  5%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[10000-50] PASSED [  5%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[10000-100] PASSED [  6%]
test.py::TestKNNFinder::test_exact_match_with_ground_truth[10000-500] PASSED [  6%]
test.py::TestKNNFinder::test_single_query[100-1] PASSED                  [  7%]
test.py::TestKNNFinder::test_single_query[100-10] PASSED                 [  7%]
test.py::TestKNNFinder::test_single_query[100-50] PASSED                 [  7%]
test.py::TestKNNFinder::test_single_query[100-100] PASSED                [  8%]
test.py::TestKNNFinder::test_single_query[100-500] PASSED                [  8%]
test.py::TestKNNFinder::test_single_query[1000-1] PASSED                 [  9%]
test.py::TestKNNFinder::test_single_query[1000-10] PASSED                [  9%]
test.py::TestKNNFinder::test_single_query[1000-50] PASSED                [ 10%]
test.py::TestKNNFinder::test_single_query[1000-100] PASSED               [ 10%]
test.py::TestKNNFinder::test_single_query[1000-500] PASSED               [ 11%]
test.py::TestKNNFinder::test_single_query[10000-1] PASSED                [ 11%]
test.py::TestKNNFinder::test_single_query[10000-10] PASSED               [ 11%]
test.py::TestKNNFinder::test_single_query[10000-50] PASSED               [ 12%]
test.py::TestKNNFinder::test_single_query[10000-100] PASSED              [ 12%]
test.py::TestKNNFinder::test_single_query[10000-500] PASSED              [ 13%]
test.py::TestKNNFinder::test_batch_query[100-1] PASSED                   [ 13%]
test.py::TestKNNFinder::test_batch_query[100-10] PASSED                  [ 14%]
test.py::TestKNNFinder::test_batch_query[100-50] PASSED                  [ 14%]
test.py::TestKNNFinder::test_batch_query[100-100] PASSED                 [ 14%]
test.py::TestKNNFinder::test_batch_query[100-500] PASSED                 [ 15%]
test.py::TestKNNFinder::test_batch_query[1000-1] PASSED                  [ 15%]
test.py::TestKNNFinder::test_batch_query[1000-10] PASSED                 [ 16%]
test.py::TestKNNFinder::test_batch_query[1000-50] PASSED                 [ 16%]
test.py::TestKNNFinder::test_batch_query[1000-100] PASSED                [ 17%]
test.py::TestKNNFinder::test_batch_query[1000-500] PASSED                [ 17%]
test.py::TestKNNFinder::test_batch_query[10000-1] PASSED                 [ 18%]
test.py::TestKNNFinder::test_batch_query[10000-10] PASSED                [ 18%]
test.py::TestKNNFinder::test_batch_query[10000-50] PASSED                [ 18%]
test.py::TestKNNFinder::test_batch_query[10000-100] PASSED               [ 19%]
test.py::TestKNNFinder::test_batch_query[10000-500] PASSED               [ 19%]
test.py::TestFAISSFlat::test_exact_search_high_dim[100-1] SKIPPED (F...) [ 20%]
test.py::TestFAISSFlat::test_exact_search_high_dim[100-10] PASSED        [ 20%]
test.py::TestFAISSFlat::test_exact_search_high_dim[100-50] PASSED        [ 21%]
test.py::TestFAISSFlat::test_exact_search_high_dim[100-100] PASSED       [ 21%]
test.py::TestFAISSFlat::test_exact_search_high_dim[100-500] PASSED       [ 22%]
test.py::TestFAISSFlat::test_exact_search_high_dim[1000-1] SKIPPED (...) [ 22%]
test.py::TestFAISSFlat::test_exact_search_high_dim[1000-10] PASSED       [ 22%]
test.py::TestFAISSFlat::test_exact_search_high_dim[1000-50] PASSED       [ 23%]
test.py::TestFAISSFlat::test_exact_search_high_dim[1000-100] PASSED      [ 23%]
test.py::TestFAISSFlat::test_exact_search_high_dim[1000-500] PASSED      [ 24%]
test.py::TestFAISSFlat::test_exact_search_high_dim[10000-1] SKIPPED      [ 24%]
test.py::TestFAISSFlat::test_exact_search_high_dim[10000-10] PASSED      [ 25%]
test.py::TestFAISSFlat::test_exact_search_high_dim[10000-50] PASSED      [ 25%]
test.py::TestFAISSFlat::test_exact_search_high_dim[10000-100] PASSED     [ 25%]
test.py::TestFAISSFlat::test_exact_search_high_dim[10000-500] PASSED     [ 26%]
test.py::TestFAISSFlat::test_low_dimension_warning[100-1] PASSED         [ 26%]
test.py::TestFAISSFlat::test_low_dimension_warning[100-10] SKIPPED (...) [ 27%]
test.py::TestFAISSFlat::test_low_dimension_warning[100-50] SKIPPED (...) [ 27%]
test.py::TestFAISSFlat::test_low_dimension_warning[100-100] SKIPPED      [ 28%]
test.py::TestFAISSFlat::test_low_dimension_warning[100-500] SKIPPED      [ 28%]
test.py::TestFAISSFlat::test_low_dimension_warning[1000-1] PASSED        [ 29%]
test.py::TestFAISSFlat::test_low_dimension_warning[1000-10] SKIPPED      [ 29%]
test.py::TestFAISSFlat::test_low_dimension_warning[1000-50] SKIPPED      [ 29%]
test.py::TestFAISSFlat::test_low_dimension_warning[1000-100] SKIPPED     [ 30%]
test.py::TestFAISSFlat::test_low_dimension_warning[1000-500] SKIPPED     [ 30%]
test.py::TestFAISSFlat::test_low_dimension_warning[10000-1] PASSED       [ 31%]
test.py::TestFAISSFlat::test_low_dimension_warning[10000-10] SKIPPED     [ 31%]
test.py::TestFAISSFlat::test_low_dimension_warning[10000-50] SKIPPED     [ 32%]
test.py::TestFAISSFlat::test_low_dimension_warning[10000-100] SKIPPED    [ 32%]
test.py::TestFAISSFlat::test_low_dimension_warning[10000-500] SKIPPED    [ 33%]
test.py::TestFAISSFlat::test_returns_k_neighbors[100-1] PASSED           [ 33%]
test.py::TestFAISSFlat::test_returns_k_neighbors[100-10] PASSED          [ 33%]
test.py::TestFAISSFlat::test_returns_k_neighbors[100-50] PASSED          [ 34%]
test.py::TestFAISSFlat::test_returns_k_neighbors[100-100] PASSED         [ 34%]
test.py::TestFAISSFlat::test_returns_k_neighbors[100-500] PASSED         [ 35%]
test.py::TestFAISSFlat::test_returns_k_neighbors[1000-1] PASSED          [ 35%]
test.py::TestFAISSFlat::test_returns_k_neighbors[1000-10] PASSED         [ 36%]
test.py::TestFAISSFlat::test_returns_k_neighbors[1000-50] PASSED         [ 36%]
test.py::TestFAISSFlat::test_returns_k_neighbors[1000-100] PASSED        [ 37%]
test.py::TestFAISSFlat::test_returns_k_neighbors[1000-500] PASSED        [ 37%]
test.py::TestFAISSFlat::test_returns_k_neighbors[10000-1] PASSED         [ 37%]
test.py::TestFAISSFlat::test_returns_k_neighbors[10000-10] PASSED        [ 38%]
test.py::TestFAISSFlat::test_returns_k_neighbors[10000-50] PASSED        [ 38%]
test.py::TestFAISSFlat::test_returns_k_neighbors[10000-100] PASSED       [ 39%]
test.py::TestFAISSFlat::test_returns_k_neighbors[10000-500] PASSED       [ 39%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[100-1] SKIPPED [ 40%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[100-10] SKIPPED [ 40%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[100-50] SKIPPED [ 40%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[100-100] SKIPPED [ 41%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[100-500] SKIPPED [ 41%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[1000-1] SKIPPED [ 42%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[1000-10] PASSED [ 42%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[1000-50] PASSED [ 43%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[1000-100] PASSED [ 43%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[1000-500] PASSED [ 44%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[10000-1] SKIPPED [ 44%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[10000-10] PASSED [ 44%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[10000-50] PASSED [ 45%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[10000-100] FAILED [ 45%]
test.py::TestFAISSIVF::test_high_recall_with_enough_probes[10000-500] PASSED [ 46%]
test.py::TestFAISSIVF::test_low_probes_warning[100-1] SKIPPED (Need ...) [ 46%]
test.py::TestFAISSIVF::test_low_probes_warning[100-10] SKIPPED (Need...) [ 47%]
test.py::TestFAISSIVF::test_low_probes_warning[100-50] SKIPPED (Need...) [ 47%]
test.py::TestFAISSIVF::test_low_probes_warning[100-100] SKIPPED (Nee...) [ 48%]
test.py::TestFAISSIVF::test_low_probes_warning[100-500] SKIPPED (Nee...) [ 48%]
test.py::TestFAISSIVF::test_low_probes_warning[1000-1] PASSED            [ 48%]
test.py::TestFAISSIVF::test_low_probes_warning[1000-10] PASSED           [ 49%]
test.py::TestFAISSIVF::test_low_probes_warning[1000-50] PASSED           [ 49%]
test.py::TestFAISSIVF::test_low_probes_warning[1000-100] PASSED          [ 50%]
test.py::TestFAISSIVF::test_low_probes_warning[1000-500] PASSED          [ 50%]
test.py::TestFAISSIVF::test_low_probes_warning[10000-1] PASSED           [ 51%]
test.py::TestFAISSIVF::test_low_probes_warning[10000-10] PASSED          [ 51%]
test.py::TestFAISSIVF::test_low_probes_warning[10000-50] PASSED          [ 51%]
test.py::TestFAISSIVF::test_low_probes_warning[10000-100] PASSED         [ 52%]
test.py::TestFAISSIVF::test_low_probes_warning[10000-500] PASSED         [ 52%]
test.py::TestFAISSIVF::test_auto_ncells_computation[100-1] SKIPPED (...) [ 53%]
test.py::TestFAISSIVF::test_auto_ncells_computation[100-10] SKIPPED      [ 53%]
test.py::TestFAISSIVF::test_auto_ncells_computation[100-50] SKIPPED      [ 54%]
test.py::TestFAISSIVF::test_auto_ncells_computation[100-100] SKIPPED     [ 54%]
test.py::TestFAISSIVF::test_auto_ncells_computation[100-500] SKIPPED     [ 55%]
test.py::TestFAISSIVF::test_auto_ncells_computation[1000-1] PASSED       [ 55%]
test.py::TestFAISSIVF::test_auto_ncells_computation[1000-10] PASSED      [ 55%]
test.py::TestFAISSIVF::test_auto_ncells_computation[1000-50] PASSED      [ 56%]
test.py::TestFAISSIVF::test_auto_ncells_computation[1000-100] PASSED     [ 56%]
test.py::TestFAISSIVF::test_auto_ncells_computation[1000-500] PASSED     [ 57%]
test.py::TestFAISSIVF::test_auto_ncells_computation[10000-1] PASSED      [ 57%]
test.py::TestFAISSIVF::test_auto_ncells_computation[10000-10] PASSED     [ 58%]
test.py::TestFAISSIVF::test_auto_ncells_computation[10000-50] PASSED     [ 58%]
test.py::TestFAISSIVF::test_auto_ncells_computation[10000-100] PASSED    [ 59%]
test.py::TestFAISSIVF::test_auto_ncells_computation[10000-500] PASSED    [ 59%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[100-1] PASSED [ 59%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[100-10] PASSED [ 60%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[100-50] PASSED [ 60%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[100-100] PASSED [ 61%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[100-500] PASSED [ 61%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[1000-1] PASSED [ 62%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[1000-10] PASSED [ 62%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[1000-50] PASSED [ 62%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[1000-100] PASSED [ 63%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[1000-500] PASSED [ 63%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[10000-1] PASSED [ 64%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[10000-10] PASSED [ 64%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[10000-50] PASSED [ 65%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[10000-100] PASSED [ 65%]
test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[10000-500] PASSED [ 66%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[100-1] SKIPPED [ 66%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[100-10] SKIPPED [ 66%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[100-50] SKIPPED [ 67%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[100-100] SKIPPED [ 67%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[100-500] SKIPPED [ 68%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[1000-1] SKIPPED [ 68%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[1000-10] SKIPPED [ 69%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[1000-50] SKIPPED [ 69%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[1000-100] SKIPPED [ 70%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[1000-500] SKIPPED [ 70%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[10000-1] SKIPPED [ 70%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[10000-10] SKIPPED [ 71%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[10000-50] SKIPPED [ 71%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[10000-100] SKIPPED [ 72%]
test.py::TestAnnoyFinder::test_high_recall_in_high_dimensions[10000-500] SKIPPED [ 72%]
test.py::TestAnnoyFinder::test_low_dimension_warning[100-1] PASSED       [ 73%]
test.py::TestAnnoyFinder::test_low_dimension_warning[100-10] SKIPPED     [ 73%]
test.py::TestAnnoyFinder::test_low_dimension_warning[100-50] SKIPPED     [ 74%]
test.py::TestAnnoyFinder::test_low_dimension_warning[100-100] SKIPPED    [ 74%]
test.py::TestAnnoyFinder::test_low_dimension_warning[100-500] SKIPPED    [ 74%]
test.py::TestAnnoyFinder::test_low_dimension_warning[1000-1] PASSED      [ 75%]
test.py::TestAnnoyFinder::test_low_dimension_warning[1000-10] SKIPPED    [ 75%]
test.py::TestAnnoyFinder::test_low_dimension_warning[1000-50] SKIPPED    [ 76%]
test.py::TestAnnoyFinder::test_low_dimension_warning[1000-100] SKIPPED   [ 76%]
test.py::TestAnnoyFinder::test_low_dimension_warning[1000-500] SKIPPED   [ 77%]
test.py::TestAnnoyFinder::test_low_dimension_warning[10000-1] PASSED     [ 77%]
test.py::TestAnnoyFinder::test_low_dimension_warning[10000-10] SKIPPED   [ 77%]
test.py::TestAnnoyFinder::test_low_dimension_warning[10000-50] SKIPPED   [ 78%]
test.py::TestAnnoyFinder::test_low_dimension_warning[10000-100] SKIPPED  [ 78%]
test.py::TestAnnoyFinder::test_low_dimension_warning[10000-500] SKIPPED  [ 79%]
test.py::TestAnnoyFinder::test_search_k_auto_computation PASSED          [ 79%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[100-1-hnswlib] SKIPPED [ 80%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[100-10-hnswlib] SKIPPED [ 80%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[100-50-hnswlib] SKIPPED [ 81%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[100-100-hnswlib] SKIPPED [ 81%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[100-500-hnswlib] SKIPPED [ 81%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[1000-1-hnswlib] SKIPPED [ 82%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[1000-10-hnswlib] SKIPPED [ 82%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[1000-50-hnswlib] PASSED [ 83%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[1000-100-hnswlib] PASSED [ 83%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[1000-500-hnswlib] PASSED [ 84%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[10000-1-hnswlib] SKIPPED [ 84%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[10000-10-hnswlib] SKIPPED [ 85%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[10000-50-hnswlib] PASSED [ 85%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[10000-100-hnswlib] PASSED [ 85%]
test.py::TestHNSWFinder::test_high_recall_in_high_dimensions[10000-500-hnswlib] PASSED [ 86%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[100-1] SKIPPED [ 86%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[100-10] SKIPPED [ 87%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[100-50] SKIPPED [ 87%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[100-100] SKIPPED [ 88%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[100-500] SKIPPED [ 88%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[1000-1] SKIPPED [ 88%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[1000-10] SKIPPED [ 89%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[1000-50] SKIPPED [ 89%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[1000-100] SKIPPED [ 90%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[1000-500] SKIPPED [ 90%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[10000-1] PASSED [ 91%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[10000-10] PASSED [ 91%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[10000-50] PASSED [ 92%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[10000-100] PASSED [ 92%]
test.py::TestHNSWFinder::test_low_ef_construction_warning[10000-500] PASSED [ 92%]
test.py::TestDynamicRouterIntegration::test_preset_balanced FAILED       [ 93%]
test.py::TestDynamicRouterIntegration::test_preset_exact PASSED          [ 93%]
test.py::TestDynamicRouterIntegration::test_preset_turbo PASSED          [ 94%]
test.py::TestDynamicRouterIntegration::test_from_data_size_small PASSED  [ 94%]
test.py::TestDynamicRouterIntegration::test_from_data_size_low_dim PASSED [ 95%]
test.py::TestDynamicRouterIntegration::test_from_data_size_high_dim FAILED [ 95%]
test.py::TestEdgeCases::test_k_equals_n_samples PASSED                   [ 96%]
test.py::TestEdgeCases::test_k_greater_than_n_samples PASSED             [ 96%]
test.py::TestEdgeCases::test_1d_data PASSED                              [ 96%]
test.py::TestEdgeCases::test_empty_result_handling PASSED                [ 97%]
test.py::TestPerformance::test_faiss_faster_than_knn_large_dataset PASSED [ 97%]
test.py::TestPerformance::test_query_time_scales_with_k PASSED           [ 98%]
test.py::TestValidation::test_invalid_index_type PASSED                  [ 98%]
test.py::TestValidation::test_invalid_preset PASSED                      [ 99%]
test.py::TestValidation::test_custom_preset_requires_finder PASSED       [ 99%]
test.py::TestValidation::test_negative_k PASSED                          [100%]

=================================== FAILURES ===================================
_________ TestFAISSIVF.test_high_recall_with_enough_probes[10000-100] __________
test.py:214: in test_high_recall_with_enough_probes
    assert recall > 0.90, f"FAISS IVF recall {recall:.4f} should be >0.90 with n_probes=50"
E   AssertionError: FAISS IVF recall 0.8490 should be >0.90 with n_probes=50
E   assert np.float64(0.8490000000000002) > 0.9
______________ TestDynamicRouterIntegration.test_preset_balanced _______________
test.py:450: in test_preset_balanced
    weights = router.predict(test_features[i:i+1])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../src/ensemble_weights/__init__.py:229: in predict
    return self.model.predict(x, temperature)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../src/ensemble_weights/models/knn.py:44: in predict
    max_scores = np.max(avg_scores, axis=1, keepdims=True)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../Library/Python/3.13/lib/python/site-packages/numpy/_core/fromnumeric.py:3199: in max
    return _wrapreduction(a, np.maximum, 'max', axis, None, out,
../../Library/Python/3.13/lib/python/site-packages/numpy/_core/fromnumeric.py:86: in _wrapreduction
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   numpy.exceptions.AxisError: axis 1 is out of bounds for array of dimension 1
----------------------------- Captured stdout call -----------------------------
Using preset 'balanced': Good balance of speed and accuracy (~98% recall)
----------------------------- Captured stderr call -----------------------------
WARNING clustering 1000 points to 31 centroids: please provide at least 1209 training points
__________ TestDynamicRouterIntegration.test_from_data_size_high_dim ___________
test.py:537: in test_from_data_size_high_dim
    assert 'high_dim' in router.preset
E   AssertionError: assert 'high_dim' in 'balanced'
E    +  where 'balanced' = <ensemble_weights.__init__.DynamicRouter object at 0x1201cf1d0>.preset
----------------------------- Captured stdout call -----------------------------
Auto-selected preset: 'balanced'
Reason: Medium dataset (10K-100K samples) - balanced speed/accuracy
Data: 50,000 samples, 200 features
Using preset 'balanced': Good balance of speed and accuracy (~98% recall)
=============================== warnings summary ===============================
tests/test.py::TestFAISSFlat::test_exact_search_high_dim[100-10]
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

tests/test.py::TestFAISSFlat::test_exact_search_high_dim[100-10]
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

tests/test.py::TestFAISSFlat::test_exact_search_high_dim[100-10]
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

tests/test.py::TestFAISSFlat::test_returns_k_neighbors[100-1]
tests/test.py::TestFAISSFlat::test_returns_k_neighbors[1000-1]
tests/test.py::TestFAISSFlat::test_returns_k_neighbors[10000-1]
  /Users/tikhon.vodyanov/Ensemble-weights/src/ensemble_weights/neighbors.py:89: UserWarning: FAISS Flat may have precision issues in 1D due to floating-point arithmetic. For 1D or 2D data, consider using KNN (sklearn) instead.
    warnings.warn(

tests/test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[100-1]
tests/test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[1000-1]
tests/test.py::TestAnnoyFinder::test_returns_exactly_k_neighbors[10000-1]
  /Users/tikhon.vodyanov/Ensemble-weights/src/ensemble_weights/neighbors.py:202: UserWarning: Annoy may have poor performance in 1D. Tree structure can degenerate in low dimensions. Consider using KNN or FAISS Flat for low-dimensional data.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED test.py::TestFAISSIVF::test_high_recall_with_enough_probes[10000-100]
FAILED test.py::TestDynamicRouterIntegration::test_preset_balanced - numpy.ex...
FAILED test.py::TestDynamicRouterIntegration::test_from_data_size_high_dim - ...
============ 3 failed, 146 passed, 78 skipped, 9 warnings in 14.11s ============
